<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Emoji Visualizer</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://d3js.org/topojson.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <!--<script src="data/emoji.json" />-->
    <!--<script type = "text/javascript" src="geovis.js"></script>-->
  </head>

  <body>
    <!--<script type = "text/javascript" src="emoji.js"></script>-->
    <!--<div id = "vizContent">-->



    <div id = "mapDiv">
      <svg id = "mapMain"></svg>
    </div>

    <script>

    //Width and height of map
    var width = 960;
    var height = 500;

    //Create SVG element and append map to the SVG
    var svg = d3.select("svg#mapMain")
                //.append("svg")
                .attr("width", width)
                .attr("height", height);

    //var g = svg.append("g");
    var gBackground = svg.append("g");
    var gDataPoints = svg.append("g");

    // D3 Projection
    var projection = d3.geo.albersUsa()
               .translate([width/2, height/2])    // translate to center of screen
               .scale([1000]);          					// scale things down so see entire US

    // Define path generator
    var path = d3.geo.path()               // path generator that will convert GeoJSON to SVG paths
             .projection(projection);  		//tell path generator to use albersUsa projection

    d3.json("data/us.json",function(error, us){
      if (error) throw error;

      gBackground.append("g")
        .attr("id", "states")
        .selectAll("path")
        .data(topojson.feature(us, us.objects.states).features)
        .enter().append("path")
        .attr("d", path);

        gBackground.append("path")
          .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
          .attr("id", "state-borders")
          .attr("d", path);

      });

      d3.json("data/us-cities.json",function(error, city){
        if (error) throw error;

        newcity = ["Albuquerque", "Atlanta", "Austin", "Baltimore", "Birmingham", "Boston", "Charlotte", "Chicago", "Cincinnati", "Cleveland", "Colorado Springs", "Columbus", "Dallas-Ft. Worth", "Denver", "Detroit", "El Paso", "Fresno", "Greensboro", "Harrisburg", "Honolulu", "Indianapolis", "Jackson", "Jacksonville", "Kansas City", "Las Vegas", "Long Beach", "Louisville", "Memphis", "Milwaukee", "Nashville", "New Haven"]

        //citysubset =
        //if (city.features.properties.name == "Atlanta")
        //  console.log(city.features);
        newfeat = []

        for (i = 0;i < city.features.length;i++)
        {
              if (newcity.includes(city.features[i].properties.name) == true)
                {  newfeat.push(city.features[i]);
                }  //console.log(city.features[i].properties.name);
        }

        //console.log(newfeat);

        gDataPoints.selectAll("path")
         .data(newfeat)
         .enter()
         .append("image")
         .attr("class","path")
         .attr("xlink:href","https://raw.githubusercontent.com/HenrikJoreteg/emoji-images/master/pngs/basketball.png")
         .attr("x", function(d,i) {return projection(d.geometry.coordinates)[0];})
         .attr("y", function(d,i) {return projection(d.geometry.coordinates)[1];})
         .attr("width","20")
         .attr("height","20");

         /*gDataPoints.selectAll("path")
          .data(city.features)
          .enter()
          .append("path")
          .attr("fill","#900")
          .attr("stroke","#999")
          .attr("d",path);*/
      });

    </script>

  </body>

</html>
